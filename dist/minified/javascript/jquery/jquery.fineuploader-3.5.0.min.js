var qq=function(e){"use strict";return{hide:function(){return e.style.display="none",this},attach:function(t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n),function(){qq(e).detach(t,n)}},detach:function(t,n){return e.removeEventListener?e.removeEventListener(t,n,!1):e.attachEvent&&e.detachEvent("on"+t,n),this},contains:function(t){return e===t||(e.contains?e.contains(t):!!(8&t.compareDocumentPosition(e)))},insertBefore:function(t){return t.parentNode.insertBefore(e,t),this},remove:function(){return e.parentNode.removeChild(e),this},css:function(t){return null!==t.opacity&&"string"!=typeof e.style.opacity&&"undefined"!=typeof e.filters&&(t.filter="alpha(opacity="+Math.round(100*t.opacity)+")"),qq.extend(e.style,t),this},hasClass:function(t){var n=new RegExp("(^| )"+t+"( |$)");return n.test(e.className)},addClass:function(t){return qq(e).hasClass(t)||(e.className+=" "+t),this},removeClass:function(t){var n=new RegExp("(^| )"+t+"( |$)");return e.className=e.className.replace(n," ").replace(/^\s+|\s+$/g,""),this},getByClass:function(t){var n,o=[];return e.querySelectorAll?e.querySelectorAll("."+t):(n=e.getElementsByTagName("*"),qq.each(n,function(e,n){qq(n).hasClass(t)&&o.push(n)}),o)},children:function(){for(var t=[],n=e.firstChild;n;)1===n.nodeType&&t.push(n),n=n.nextSibling;return t},setText:function(t){return e.innerText=t,e.textContent=t,this},clearText:function(){return qq(e).setText("")}}};qq.log=function(e,t){"use strict";window.console&&(t&&"info"!==t?window.console[t]?window.console[t](e):window.console.log("<"+t+"> "+e):window.console.log(e))},qq.isObject=function(e){"use strict";return null!==e&&e&&"object"==typeof e&&e.constructor===Object},qq.isFunction=function(e){"use strict";return"function"==typeof e},qq.isString=function(e){"use strict";return"[object String]"===Object.prototype.toString.call(e)},qq.trimStr=function(e){return String.prototype.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},qq.isFileOrInput=function(e){"use strict";if(window.File&&e instanceof File)return!0;if(window.HTMLInputElement){if(e instanceof HTMLInputElement&&e.type&&"file"===e.type.toLowerCase())return!0}else if(e.tagName&&"input"===e.tagName.toLowerCase()&&e.type&&"file"===e.type.toLowerCase())return!0;return!1},qq.isBlob=function(e){"use strict";return window.Blob&&"[object Blob]"===Object.prototype.toString.call(e)},qq.isXhrUploadSupported=function(){"use strict";var e=document.createElement("input");return e.type="file",void 0!==e.multiple&&"undefined"!=typeof File&&"undefined"!=typeof FormData&&"undefined"!=typeof(new XMLHttpRequest).upload},qq.isFolderDropSupported=function(e){"use strict";return e.items&&e.items[0].webkitGetAsEntry},qq.isFileChunkingSupported=function(){"use strict";return!qq.android()&&qq.isXhrUploadSupported()&&(void 0!==File.prototype.slice||void 0!==File.prototype.webkitSlice||void 0!==File.prototype.mozSlice)},qq.extend=function(e,t,n){"use strict";qq.each(t,function(t,o){n&&qq.isObject(o)?(void 0===e[t]&&(e[t]={}),qq.extend(e[t],o,!0)):e[t]=o})},qq.indexOf=function(e,t,n){"use strict";if(e.indexOf)return e.indexOf(t,n);n=n||0;var o=e.length;for(n<0&&(n+=o);n<o;n+=1)if(e.hasOwnProperty(n)&&e[n]===t)return n;return-1},qq.getUniqueId=function(){"use strict";return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},qq.ie=function(){"use strict";return navigator.userAgent.indexOf("MSIE")!==-1},qq.ie10=function(){"use strict";return navigator.userAgent.indexOf("MSIE 10")!==-1},qq.safari=function(){"use strict";return void 0!==navigator.vendor&&navigator.vendor.indexOf("Apple")!==-1},qq.chrome=function(){"use strict";return void 0!==navigator.vendor&&navigator.vendor.indexOf("Google")!==-1},qq.firefox=function(){"use strict";return navigator.userAgent.indexOf("Mozilla")!==-1&&void 0!==navigator.vendor&&""===navigator.vendor},qq.windows=function(){"use strict";return"Win32"===navigator.platform},qq.android=function(){"use strict";return navigator.userAgent.toLowerCase().indexOf("android")!==-1},qq.preventDefault=function(e){"use strict";e.preventDefault?e.preventDefault():e.returnValue=!1},qq.toElement=function(){"use strict";var e=document.createElement("div");return function(t){e.innerHTML=t;var n=e.firstChild;return e.removeChild(n),n}}(),qq.each=function(e,t){"use strict";var n,o;if(e)for(n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&(o=t(n,e[n]),o===!1))break},qq.obj2url=function(e,t,n){"use strict";var o,i,s=[],r="&",a=function(e,n){var o=t?/\[\]$/.test(t)?t:t+"["+n+"]":n;"undefined"!==o&&"undefined"!==n&&s.push("object"==typeof e?qq.obj2url(e,o,!0):"[object Function]"===Object.prototype.toString.call(e)?encodeURIComponent(o)+"="+encodeURIComponent(e()):encodeURIComponent(o)+"="+encodeURIComponent(e))};if(!n&&t)r=/\?/.test(t)?/\?$/.test(t)?"":"&":"?",s.push(t),s.push(qq.obj2url(e));else if("[object Array]"===Object.prototype.toString.call(e)&&"undefined"!=typeof e)for(o=-1,i=e.length;o<i;o+=1)a(e[o],o);else if("undefined"!=typeof e&&null!==e&&"object"==typeof e)for(o in e)e.hasOwnProperty(o)&&a(e[o],o);else s.push(encodeURIComponent(t)+"="+encodeURIComponent(e));return t?s.join(r):s.join(r).replace(/^&/,"").replace(/%20/g,"+")},qq.obj2FormData=function(e,t,n){"use strict";return t||(t=new FormData),qq.each(e,function(e,o){e=n?n+"["+e+"]":e,qq.isObject(o)?qq.obj2FormData(o,t,e):qq.isFunction(o)?t.append(e,o()):t.append(e,o)}),t},qq.obj2Inputs=function(e,t){"use strict";var n;return t||(t=document.createElement("form")),qq.obj2FormData(e,{append:function(e,o){n=document.createElement("input"),n.setAttribute("name",e),n.setAttribute("value",o),t.appendChild(n)}}),t},qq.setCookie=function(e,t,n){var o=new Date,i="";n&&(o.setTime(o.getTime()+24*n*60*60*1e3),i="; expires="+o.toGMTString()),document.cookie=e+"="+t+i+"; path=/"},qq.getCookie=function(e){for(var t,n=e+"=",o=document.cookie.split(";"),i=0;i<o.length;i++){for(t=o[i];" "==t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(n))return t.substring(n.length,t.length)}},qq.getCookieNames=function(e){var t=document.cookie.split(";"),n=[];return qq.each(t,function(t,o){o=qq.trimStr(o);var i=o.indexOf("=");o.match(e)&&n.push(o.substr(0,i))}),n},qq.deleteCookie=function(e){qq.setCookie(e,"",-1)},qq.areCookiesEnabled=function(){var e=1e5*Math.random(),t="qqCookieTest:"+e;return qq.setCookie(t,1),!!qq.getCookie(t)&&(qq.deleteCookie(t),!0)},qq.parseJson=function(json){return window.JSON&&qq.isFunction(JSON.parse)?JSON.parse(json):eval("("+json+")")},qq.DisposeSupport=function(){"use strict";var e=[];return{dispose:function(){var t;do t=e.shift(),t&&t();while(t)},attach:function(){var e=arguments;this.addDisposer(qq(e[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(t){e.push(t)}}},qq.supportedFeatures=function(){function e(){var e,t=!0;try{e=document.createElement("input"),e.type="file",qq(e).hide(),e.disabled&&(t=!1)}catch(n){t=!1}return t}function t(){return qq.chrome()&&void 0!==navigator.userAgent.match(/Chrome\/[2][1-9]|Chrome\/[3-9][0-9]/)}function n(){return qq.chrome()&&void 0!==navigator.userAgent.match(/Chrome\/[1][4-9]|Chrome\/[2-9][0-9]/)}var o,i,s,r,a,l,u,d;return o=e(),i=o&&qq.isXhrUploadSupported(),s=i&&t(),r=i&&qq.isFileChunkingSupported(),a=i&&r&&qq.areCookiesEnabled(),l=i&&n(),u=o&&(void 0!==window.postMessage||i),d=i,{uploading:o,ajaxUploading:i,fileDrop:i,folderDrop:s,chunking:r,resume:a,uploadCustomHeaders:i,uploadNonMultipart:i,itemSizeValidation:i,uploadViaPaste:l,progressBar:i,uploadCors:u,deleteFileCors:d}}(),qq.Promise=function(){"use strict";var e,t,n,o,i,s=0;return{then:function(i,r){return 0===s?(n=i,o=r):s===-1&&r?r(t):i&&i(e),this},done:function(e){return 0===s?i=e:e(),this},success:function(t){return s=1,e=t,n&&n(t),i&&i(),this},failure:function(e){return s=-1,t=e,o&&o(e),i&&i(),this}}},qq.UploadButton=function(e){"use strict";function t(){var e=document.createElement("input");return i.multiple&&e.setAttribute("multiple","multiple"),i.acceptFiles&&e.setAttribute("accept",i.acceptFiles),e.setAttribute("type","file"),e.setAttribute("name",i.name),qq(e).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),i.element.appendChild(e),o.attach(e,"change",function(){i.onChange(e)}),o.attach(e,"mouseover",function(){qq(i.element).addClass(i.hoverClass)}),o.attach(e,"mouseout",function(){qq(i.element).removeClass(i.hoverClass)}),o.attach(e,"focus",function(){qq(i.element).addClass(i.focusClass)}),o.attach(e,"blur",function(){qq(i.element).removeClass(i.focusClass)}),window.attachEvent&&e.setAttribute("tabIndex","-1"),e}var n,o=new qq.DisposeSupport,i={element:null,multiple:!1,acceptFiles:null,name:"file",onChange:function(e){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};return qq.extend(i,e),qq(i.element).css({position:"relative",overflow:"hidden",direction:"ltr"}),n=t(),{getInput:function(){return n},reset:function(){n.parentNode&&qq(n).remove(),qq(i.element).removeClass(i.focusClass),n=t()}}},qq.PasteSupport=function(e){"use strict";function t(e){return e.type&&0===e.type.indexOf("image/")}function n(){qq(i.targetElement).attach("paste",function(e){var n=e.clipboardData;n&&qq.each(n.items,function(e,n){if(t(n)){var o=n.getAsFile();i.callbacks.pasteReceived(o)}})})}function o(){s&&s()}var i,s;return i={targetElement:null,callbacks:{log:function(e,t){},pasteReceived:function(e){}}},qq.extend(i,e),n(),{reset:function(){o()}}},qq.FineUploaderBasic=function(e){this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{endpoint:"/server/upload",params:{},paramsInBody:!0,customHeaders:{},forceMultipart:!0,inputName:"qqfile",uuidName:"qquuid",totalFileSizeName:"qqtotalfilesize"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,itemLimit:0,stopOnFirstInvalidFile:!0},callbacks:{onSubmit:function(e,t){},onSubmitted:function(e,t){},onComplete:function(e,t,n,o){},onCancel:function(e,t){},onUpload:function(e,t){},onUploadChunk:function(e,t,n){},onResume:function(e,t,n){},onProgress:function(e,t,n,o){},onError:function(e,t,n,o){},onAutoRetry:function(e,t,n){},onManualRetry:function(e,t){},onValidateBatch:function(e){},onValidate:function(e){},onSubmitDelete:function(e){},onDelete:function(e){},onDeleteComplete:function(e,t,n){},onPasteReceived:function(e){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",tooManyItemsError:"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.",retryFailTooManyItems:"Retry failed - you have reached your file limit.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:!1,partSize:2e6,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts",filename:"qqfilename"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},formatFileName:function(e){return e.length>33&&(e=e.slice(0,19)+"..."+e.slice(-14)),e},text:{defaultResponseError:"Upload failure reason unknown",sizeSymbols:["kB","MB","GB","TB","PB","EB"]},deleteFile:{enabled:!1,endpoint:"/server/upload",customHeaders:{},params:{}},cors:{expected:!1,sendCredentials:!1},blobs:{defaultName:"misc_data",paramNames:{name:"qqblobname"}},paste:{targetElement:null,defaultName:"pasted_image"}},qq.extend(this._options,e,!0),this._wrapCallbacks(),this._disposeSupport=new qq.DisposeSupport,this._filesInProgress=[],this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._netUploadedOrQueued=0,this._netUploaded=0,this._paramsStore=this._createParamsStore("request"),this._deleteFileParamsStore=this._createParamsStore("deleteFile"),this._endpointStore=this._createEndpointStore("request"),this._deleteFileEndpointStore=this._createEndpointStore("deleteFile"),this._handler=this._createUploadHandler(),this._deleteHandler=this._createDeleteHandler(),this._options.button&&(this._button=this._createUploadButton(this._options.button)),this._options.paste.targetElement&&(this._pasteHandler=this._createPasteHandler()),this._preventLeaveInProgress()},qq.FineUploaderBasic.prototype={log:function(e,t){!this._options.debug||t&&"info"!==t?t&&"info"!==t&&qq.log("[FineUploader] "+e,t):qq.log("[FineUploader] "+e)},setParams:function(e,t){null==t?this._options.request.params=e:this._paramsStore.setParams(e,t)},setDeleteFileParams:function(e,t){null==t?this._options.deleteFile.params=e:this._deleteFileParamsStore.setParams(e,t)},setEndpoint:function(e,t){null==t?this._options.request.endpoint=e:this._endpointStore.setEndpoint(e,t)},getInProgress:function(){return this._filesInProgress.length},getNetUploads:function(){return this._netUploaded},uploadStoredFiles:function(){"use strict";for(var e;this._storedIds.length;)e=this._storedIds.shift(),this._filesInProgress.push(e),this._handler.upload(e)},clearStoredFiles:function(){this._storedIds=[]},retry:function(e){return!!this._onBeforeManualRetry(e)&&(this._netUploadedOrQueued++,this._handler.retry(e),!0)},cancel:function(e){this._handler.cancel(e)},cancelAll:function(){var e=[],t=this;qq.extend(e,this._storedIds),qq.each(e,function(e,n){t.cancel(n)}),this._handler.cancelAll()},reset:function(){this.log("Resetting uploader..."),this._handler.reset(),this._filesInProgress=[],this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._button.reset(),this._paramsStore.reset(),this._endpointStore.reset(),this._netUploadedOrQueued=0,this._netUploaded=0,this._pasteHandler&&this._pasteHandler.reset()},addFiles:function(e,t,n){var o,i,s=this,r=[];if(e){for(window.FileList&&e instanceof FileList||(e=[].concat(e)),o=0;o<e.length;o+=1)i=e[o],qq.isFileOrInput(i)?r.push(i):s.log(i+" is not a File or INPUT element!  Ignoring!","warn");this.log("Processing "+r.length+" files or inputs..."),this._uploadFileOrBlobDataList(r,t,n)}},addBlobs:function(e,t,n){if(e){var o=[].concat(e),i=[],s=this;qq.each(o,function(e,t){qq.isBlob(t)&&!qq.isFileOrInput(t)?i.push({blob:t,name:s._options.blobs.defaultName}):qq.isObject(t)&&t.blob&&t.name?i.push(t):s.log("addBlobs: entry at index "+e+" is not a Blob or a BlobData object","error")}),this._uploadFileOrBlobDataList(i,t,n)}else this.log("undefined or non-array parameter passed into addBlobs","error")},getUuid:function(e){return this._handler.getUuid(e)},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(e){return this._handler.getSize(e)},getName:function(e){return this._handler.getName(e)},getFile:function(e){return this._handler.getFile(e)},deleteFile:function(e){this._onSubmitDelete(e)},setDeleteFileEndpoint:function(e,t){null==t?this._options.deleteFile.endpoint=e:this._deleteFileEndpointStore.setEndpoint(e,t)},_createUploadButton:function(e){var t=this,n=new qq.UploadButton({element:e,multiple:this._options.multiple&&qq.supportedFeatures.ajaxUploading,acceptFiles:this._options.validation.acceptFiles,onChange:function(e){t._onInputChange(e)},hoverClass:this._options.classes.buttonHover,focusClass:this._options.classes.buttonFocus});return this._disposeSupport.addDisposer(function(){n.dispose()}),n},_createUploadHandler:function(){var e=this;return new qq.UploadHandler({debug:this._options.debug,forceMultipart:this._options.request.forceMultipart,maxConnections:this._options.maxConnections,customHeaders:this._options.request.customHeaders,inputName:this._options.request.inputName,uuidParamName:this._options.request.uuidName,totalFileSizeParamName:this._options.request.totalFileSizeName,cors:this._options.cors,demoMode:this._options.demoMode,paramsInBody:this._options.request.paramsInBody,paramsStore:this._paramsStore,endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,blobs:this._options.blobs,log:function(t,n){e.log(t,n)},onProgress:function(t,n,o,i){e._onProgress(t,n,o,i),e._options.callbacks.onProgress(t,n,o,i)},onComplete:function(t,n,o,i){e._onComplete(t,n,o,i),e._options.callbacks.onComplete(t,n,o,i)},onCancel:function(t,n){e._onCancel(t,n),e._options.callbacks.onCancel(t,n)},onUpload:function(t,n){e._onUpload(t,n),e._options.callbacks.onUpload(t,n)},onUploadChunk:function(t,n,o){e._options.callbacks.onUploadChunk(t,n,o)},onResume:function(t,n,o){return e._options.callbacks.onResume(t,n,o)},onAutoRetry:function(t,n,o,i){return e._preventRetries[t]=o[e._options.retry.preventRetryResponseProperty],!!e._shouldAutoRetry(t,n,o)&&(e._maybeParseAndSendUploadError(t,n,o,i),e._options.callbacks.onAutoRetry(t,n,e._autoRetries[t]+1),e._onBeforeAutoRetry(t,n),e._retryTimeouts[t]=setTimeout(function(){e._onAutoRetry(t,n,o)},1e3*e._options.retry.autoAttemptDelay),!0)}})},_createDeleteHandler:function(){var e=this;return new qq.DeleteFileAjaxRequestor({maxConnections:this._options.maxConnections,customHeaders:this._options.deleteFile.customHeaders,paramsStore:this._deleteFileParamsStore,endpointStore:this._deleteFileEndpointStore,demoMode:this._options.demoMode,cors:this._options.cors,log:function(t,n){e.log(t,n)},onDelete:function(t){e._onDelete(t),e._options.callbacks.onDelete(t)},onDeleteComplete:function(t,n,o){e._onDeleteComplete(t,n,o),e._options.callbacks.onDeleteComplete(t,n,o)}})},_createPasteHandler:function(){var e=this;return new qq.PasteSupport({targetElement:this._options.paste.targetElement,callbacks:{log:function(t,n){e.log(t,n)},pasteReceived:function(t){var n=e._options.callbacks.onPasteReceived,o=n(t);o&&o.then?o.then(function(n){e._handlePasteSuccess(t,n)},function(t){e.log("Ignoring pasted image per paste received callback.  Reason = '"+t+"'")}):e._handlePasteSuccess(t)}}})},_handlePasteSuccess:function(e,t){var n=e.type.split("/")[1],o=t;null==o&&(o=this._options.paste.defaultName),o+="."+n,this.addBlobs({name:o,blob:e})},_preventLeaveInProgress:function(){var e=this;this._disposeSupport.attach(window,"beforeunload",function(t){if(e._filesInProgress.length){var t=t||window.event;return t.returnValue=e._options.messages.onLeave,e._options.messages.onLeave}})},_onSubmit:function(e,t){this._netUploadedOrQueued++,this._options.autoUpload&&this._filesInProgress.push(e)},_onProgress:function(e,t,n,o){},_onComplete:function(e,t,n,o){n.success?this._netUploaded++:this._netUploadedOrQueued--,this._removeFromFilesInProgress(e),this._maybeParseAndSendUploadError(e,t,n,o)},_onCancel:function(e,t){this._netUploadedOrQueued--,this._removeFromFilesInProgress(e),clearTimeout(this._retryTimeouts[e]);var n=qq.indexOf(this._storedIds,e);!this._options.autoUpload&&n>=0&&this._storedIds.splice(n,1)},_isDeletePossible:function(){return this._options.deleteFile.enabled&&(!this._options.cors.expected||qq.supportedFeatures.deleteFileCors)},_onSubmitDelete:function(e){return this._isDeletePossible()?void(this._options.callbacks.onSubmitDelete(e)!==!1&&this._deleteHandler.sendDelete(e,this.getUuid(e))):(this.log("Delete request ignored for ID "+e+", delete feature is disabled or request not possible due to CORS on a user agent that does not support pre-flighting.","warn"),!1)},_onDelete:function(e){},_onDeleteComplete:function(e,t,n){var o=this._handler.getName(e);n?(this.log("Delete request for '"+o+"' has failed.","error"),this._options.callbacks.onError(e,o,"Delete request failed with response code "+t.status,t)):(this._netUploadedOrQueued--,this._netUploaded--,this.log("Delete request for '"+o+"' has succeeded."))},_removeFromFilesInProgress:function(e){var t=qq.indexOf(this._filesInProgress,e);t>=0&&this._filesInProgress.splice(t,1)},_onUpload:function(e,t){},_onInputChange:function(e){qq.supportedFeatures.ajaxUploading?this.addFiles(e.files):this.addFiles(e),this._button.reset()},_onBeforeAutoRetry:function(e,t){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+t+"...")},_onAutoRetry:function(e,t,n){this.log("Retrying "+t+"..."),this._autoRetries[e]++,this._handler.retry(e)},_shouldAutoRetry:function(e,t,n){return!(this._preventRetries[e]||!this._options.retry.enableAuto)&&(void 0===this._autoRetries[e]&&(this._autoRetries[e]=0),this._autoRetries[e]<this._options.retry.maxAutoAttempts)},_onBeforeManualRetry:function(e){var t=this._options.validation.itemLimit;if(this._preventRetries[e])return this.log("Retries are forbidden for id "+e,"warn"),!1;if(this._handler.isValid(e)){var n=this._handler.getName(e);return this._options.callbacks.onManualRetry(e,n)!==!1&&(t>0&&this._netUploadedOrQueued+1>t?(this._itemError("retryFailTooManyItems",""),!1):(this.log("Retrying upload for '"+n+"' (id: "+e+")..."),this._filesInProgress.push(e),!0))}return this.log("'"+e+"' is not a valid file ID","error"),!1},_maybeParseAndSendUploadError:function(e,t,n,o){if(!n.success)if(o&&200!==o.status&&!n.error)this._options.callbacks.onError(e,t,"XHR returned response code "+o.status,o);else{var i=n.error?n.error:this._options.text.defaultResponseError;this._options.callbacks.onError(e,t,i,o)}},_uploadFileOrBlobDataList:function(e,t,n){var o,i=this._getValidationDescriptors(e),s=this._isBatchValid(i);if(s)if(e.length>0){for(o=0;o<e.length;o++)if(this._validateFileOrBlobData(e[o]))this._upload(e[o],t,n);else if(this._options.validation.stopOnFirstInvalidFile)return}else this._itemError("noFilesError","")},_upload:function(e,t,n){var o=this._handler.add(e),i=this._handler.getName(o);t&&this.setParams(t,o),n&&this.setEndpoint(n,o),this._options.callbacks.onSubmit(o,i)!==!1&&(this._onSubmit(o,i),this._options.callbacks.onSubmitted(o,i),this._options.autoUpload?this._handler.upload(o):this._storeForLater(o))},_storeForLater:function(e){this._storedIds.push(e)},_isBatchValid:function(e){var t,n=this._options.validation.itemLimit,o=this._netUploadedOrQueued+e.length,i=this._options.callbacks.onValidateBatch(e)!==!1;return i&&(0===n||o<=n?i=!0:(i=!1,t=this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,o).replace(/\{itemLimit\}/g,n),this._batchError(t))),i},_validateFileOrBlobData:function(e){var t,n,o;return t=this._getValidationDescriptor(e),n=t.name,o=t.size,this._options.callbacks.onValidate(t)!==!1&&(qq.isFileOrInput(e)&&!this._isAllowedExtension(n)?(this._itemError("typeError",n),!1):0===o?(this._itemError("emptyError",n),!1):o&&this._options.validation.sizeLimit&&o>this._options.validation.sizeLimit?(this._itemError("sizeError",n),!1):!(o&&o<this._options.validation.minSizeLimit)||(this._itemError("minSizeError",n),!1))},_itemError:function(e,t){function n(e,t){s=s.replace(e,t)}var o,i,s=this._options.messages[e],r=[],a=[].concat(t),l=a[0];return qq.each(this._options.validation.allowedExtensions,function(e,t){qq.isString(t)&&r.push(t)}),o=r.join(", ").toLowerCase(),n("{file}",this._options.formatFileName(l)),n("{extensions}",o),n("{sizeLimit}",this._formatSize(this._options.validation.sizeLimit)),n("{minSizeLimit}",this._formatSize(this._options.validation.minSizeLimit)),i=s.match(/(\{\w+\})/g),null!==i&&qq.each(i,function(e,t){n(t,a[e])}),this._options.callbacks.onError(null,l,s),s},_batchError:function(e){this._options.callbacks.onError(null,null,e)},_isAllowedExtension:function(e){var t=this._options.validation.allowedExtensions,n=!1;return!t.length||(qq.each(t,function(t,o){if(qq.isString(o)){var i=new RegExp("\\."+o+"$","i");if(null!=e.match(i))return n=!0,!1}}),n)},_formatSize:function(e){var t=-1;do e/=1024,t++;while(e>99);return Math.max(e,.1).toFixed(1)+this._options.text.sizeSymbols[t]},_wrapCallbacks:function(){var e,t;e=this,t=function(t,n,o){try{return n.apply(e,o)}catch(i){e.log("Caught exception in '"+t+"' callback - "+i.message,"error")}};for(var n in this._options.callbacks)!function(){var o,i;o=n,i=e._options.callbacks[o],e._options.callbacks[o]=function(){return t(o,i,arguments)}}()},_parseFileOrBlobDataName:function(e){var t;return t=qq.isFileOrInput(e)?e.value?e.value.replace(/.*(\/|\\)/,""):null!==e.fileName&&void 0!==e.fileName?e.fileName:e.name:e.name},_parseFileOrBlobDataSize:function(e){var t;return qq.isFileOrInput(e)?e.value||(t=null!==e.fileSize&&void 0!==e.fileSize?e.fileSize:e.size):t=e.blob.size,t},_getValidationDescriptor:function(e){var t,n,o;return o={},t=this._parseFileOrBlobDataName(e),n=this._parseFileOrBlobDataSize(e),o.name=t,void 0!==n&&(o.size=n),o},_getValidationDescriptors:function(e){var t=this,n=[];return qq.each(e,function(e,o){n.push(t._getValidationDescriptor(o))}),n},_createParamsStore:function(e){var t={},n=this;return{setParams:function(e,n){var o={};qq.extend(o,e),t[n]=o},getParams:function(o){var i={};return null!=o&&t[o]?qq.extend(i,t[o]):qq.extend(i,n._options[e].params),i},remove:function(e){return delete t[e]},reset:function(){t={}}}},_createEndpointStore:function(e){var t={},n=this;return{setEndpoint:function(e,n){t[n]=e},getEndpoint:function(o){return null!=o&&t[o]?t[o]:n._options[e].endpoint},remove:function(e){return delete t[e]},reset:function(){t={}}}}},qq.DragAndDrop=function(e){"use strict";function t(e){a.callbacks.dropLog("Grabbed "+e.length+" dropped files."),l.dropDisabled(!1),a.callbacks.processingDroppedFilesComplete(e)}function n(e){var t,o,i=new qq.Promise;return e.isFile?e.file(function(e){u.push(e),i.success()},function(t){a.callbacks.dropLog("Problem parsing '"+e.fullPath+"'.  FileError code "+t.code+".","error"),i.failure()}):e.isDirectory&&(t=e.createReader(),t.readEntries(function(e){var t=e.length;for(o=0;o<e.length;o+=1)n(e[o]).done(function(){t-=1,0===t&&i.success()});e.length||i.success()},function(t){a.callbacks.dropLog("Problem parsing '"+e.fullPath+"'.  FileError code "+t.code+".","error"),i.failure()})),i}function o(e){var t,o,i,s=[],r=new qq.Promise;if(a.callbacks.processingDroppedFiles(),l.dropDisabled(!0),e.files.length>1&&!a.allowMultipleItems)a.callbacks.processingDroppedFilesComplete([]),a.callbacks.dropError("tooManyFilesError",""),l.dropDisabled(!1),r.failure();else{if(u=[],qq.isFolderDropSupported(e))for(o=e.items,t=0;t<o.length;t+=1)i=o[t].webkitGetAsEntry(),i&&(i.isFile?u.push(o[t].getAsFile()):s.push(n(i).done(function(){s.pop(),0===s.length&&r.success()})));else u=e.files;0===s.length&&r.success()}return r}function i(e){l=new qq.UploadDropZone({element:e,onEnter:function(t){qq(e).addClass(a.classes.dropActive),t.stopPropagation()},onLeaveNotDescendants:function(t){qq(e).removeClass(a.classes.dropActive)},onDrop:function(n){a.hideDropZonesBeforeEnter&&qq(e).hide(),qq(e).removeClass(a.classes.dropActive),o(n.dataTransfer).done(function(){t(u)})}}),d.addDisposer(function(){l.dispose()}),a.hideDropZonesBeforeEnter&&qq(e).hide()}function s(e){var t;return qq.each(e.dataTransfer.types,function(e,n){if("Files"===n)return t=!0,!1}),t}function r(){var e=a.dropZoneElements;qq.each(e,function(e,t){i(t)}),!e.length||qq.ie()&&!qq.ie10()||d.attach(document,"dragenter",function(t){!l.dropDisabled()&&s(t)&&qq.each(e,function(e,t){qq(t).css({display:"block"})})}),d.attach(document,"dragleave",function(t){a.hideDropZonesBeforeEnter&&qq.FineUploader.prototype._leaving_document_out(t)&&qq.each(e,function(e,t){qq(t).hide()})}),d.attach(document,"drop",function(t){a.hideDropZonesBeforeEnter&&qq.each(e,function(e,t){qq(t).hide()}),t.preventDefault()})}var a,l,u=[],d=new qq.DisposeSupport;return a={dropZoneElements:[],hideDropZonesBeforeEnter:!1,allowMultipleItems:!0,classes:{dropActive:null},callbacks:new qq.DragAndDrop.callbacks},qq.extend(a,e,!0),r(),{setupExtraDropzone:function(e){a.dropZoneElements.push(e),i(e)},removeDropzone:function(e){var t,n=a.dropZoneElements;for(t in n)if(n[t]===e)return n.splice(t,1)},dispose:function(){d.dispose(),l.dispose()}}},qq.DragAndDrop.callbacks=function(){return{processingDroppedFiles:function(){},processingDroppedFilesComplete:function(e){},dropError:function(e,t){qq.log("Drag & drop error code '"+e+" with these specifics: '"+t+"'","error")},dropLog:function(e,t){qq.log(e,t)}}},qq.UploadDropZone=function(e){"use strict";function t(){return qq.safari()||qq.firefox()&&qq.windows()}function n(e){u||(t?d.attach(document,"dragover",function(e){e.preventDefault()}):d.attach(document,"dragover",function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="none",e.preventDefault())}),u=!0)}function o(e){if(qq.ie()&&!qq.ie10())return!1;var t,n=e.dataTransfer,o=qq.safari();return t=!!qq.ie10()||"none"!==n.effectAllowed,n&&t&&(n.files||!o&&n.types.contains&&n.types.contains("Files"))}function i(e){return void 0!==e&&(l=e),l}function s(){d.attach(a,"dragover",function(e){if(o(e)){var t=qq.ie()?null:e.dataTransfer.effectAllowed;"move"===t||"linkMove"===t?e.dataTransfer.dropEffect="move":e.dataTransfer.dropEffect="copy",e.stopPropagation(),e.preventDefault()}}),d.attach(a,"dragenter",function(e){if(!i()){if(!o(e))return;r.onEnter(e)}}),d.attach(a,"dragleave",function(e){if(o(e)){r.onLeave(e);var t=document.elementFromPoint(e.clientX,e.clientY);qq(this).contains(t)||r.onLeaveNotDescendants(e)}}),d.attach(a,"drop",function(e){if(!i()){if(!o(e))return;e.preventDefault(),r.onDrop(e)}})}var r,a,l,u,d=new qq.DisposeSupport;return r={element:null,onEnter:function(e){},onLeave:function(e){},onLeaveNotDescendants:function(e){},onDrop:function(e){}},qq.extend(r,e),a=r.element,n(),s(),{dropDisabled:function(e){return i(e)},dispose:function(){d.dispose()}}},qq.FineUploader=function(e){qq.FineUploaderBasic.apply(this,arguments),qq.extend(this._options,{element:null,listElement:null,dragAndDrop:{extraDropzones:[],hideDropzones:!0,disableDefaultDropzone:!1},text:{uploadButton:"Upload a file",cancelButton:"Cancel",retryButton:"Retry",deleteButton:"Delete",failUpload:"Upload failed",dragZone:"Drop files here to upload",dropProcessing:"Processing dropped files...",formatProgress:"{percent}% of {total_size}",waitingForResponse:"Processing..."},template:'<div class="qq-uploader">'+(this._options.dragAndDrop&&this._options.dragAndDrop.disableDefaultDropzone?"":'<div class="qq-upload-drop-area"><span>{dragZoneText}</span></div>')+(this._options.button?"":'<div class="qq-upload-button"><div>{uploadButtonText}</div></div>')+'<span class="qq-drop-processing"><span>{dropProcessingText}</span><span class="qq-drop-processing-spinner"></span></span>'+(this._options.listElement?"":'<ul class="qq-upload-list"></ul>')+"</div>",fileTemplate:'<li><div class="qq-progress-bar"></div><span class="qq-upload-spinner"></span><span class="qq-upload-finished"></span><span class="qq-upload-file"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><a class="qq-upload-retry" href="#">{retryButtonText}</a><a class="qq-upload-delete" href="#">{deleteButtonText}</a><span class="qq-upload-status-text">{statusText}</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",finished:"qq-upload-finished",retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",size:"qq-upload-size",cancel:"qq-upload-cancel",deleteButton:"qq-upload-delete",retry:"qq-upload-retry",statusText:"qq-upload-status-text",success:"qq-upload-success",fail:"qq-upload-fail",successIcon:null,failIcon:null,dropProcessing:"qq-drop-processing",dropProcessingSpinner:"qq-drop-processing-spinner"},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file",unsupportedBrowser:"Unrecoverable error - this browser does not permit file uploading of any kind."
},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}...",showButton:!1},deleteFile:{forceConfirm:!1,confirmMessage:"Are you sure you want to delete {filename}?",deletingStatusText:"Deleting...",deletingFailedText:"Delete failed"},display:{fileSizeOnSubmit:!1},paste:{promptForName:!1,namePromptMessage:"Please name this image"},showMessage:function(e){setTimeout(function(){window.alert(e)},0)},showConfirm:function(e,t,n){setTimeout(function(){var o=window.confirm(e);o?t():n&&n()},0)},showPrompt:function(e,t){var n=new qq.Promise,o=window.prompt(e,t);return null!=o&&qq.trimStr(o).length>0?n.success(o):n.failure("Undefined or invalid user-supplied value."),n}},!0),qq.extend(this._options,e,!0),!qq.supportedFeatures.uploading||this._options.cors.expected&&!qq.supportedFeatures.uploadCors?this._options.element.innerHTML="<div>"+this._options.messages.unsupportedBrowser+"</div>":(this._wrapCallbacks(),this._options.template=this._options.template.replace(/\{dragZoneText\}/g,this._options.text.dragZone),this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,this._options.text.uploadButton),this._options.template=this._options.template.replace(/\{dropProcessingText\}/g,this._options.text.dropProcessing),this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.text.cancelButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{retryButtonText\}/g,this._options.text.retryButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{deleteButtonText\}/g,this._options.text.deleteButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{statusText\}/g,""),this._element=this._options.element,this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button||(this._button=this._createUploadButton(this._find(this._element,"button"))),this._bindCancelAndRetryEvents(),this._dnd=this._setupDragAndDrop(),this._options.paste.targetElement&&this._options.paste.promptForName&&this._setupPastePrompt())},qq.extend(qq.FineUploader.prototype,qq.FineUploaderBasic.prototype),qq.extend(qq.FineUploader.prototype,{clearStoredFiles:function(){qq.FineUploaderBasic.prototype.clearStoredFiles.apply(this,arguments),this._listElement.innerHTML=""},addExtraDropzone:function(e){this._dnd.setupExtraDropzone(e)},removeExtraDropzone:function(e){return this._dnd.removeDropzone(e)},getItemByFileId:function(e){for(var t=this._listElement.firstChild;t;){if(t.qqFileId==e)return t;t=t.nextSibling}},reset:function(){qq.FineUploaderBasic.prototype.reset.apply(this,arguments),this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._options.button||(this._button=this._createUploadButton(this._find(this._element,"button"))),this._bindCancelAndRetryEvents(),this._dnd.dispose(),this._dnd=this._setupDragAndDrop()},_removeFileItem:function(e){var t=this.getItemByFileId(e);qq(t).remove()},_setupDragAndDrop:function(){var e,t=this,n=this._find(this._element,"dropProcessing"),o=this._options.dragAndDrop.extraDropzones;return e=function(e){e.preventDefault()},this._options.dragAndDrop.disableDefaultDropzone||o.push(this._find(this._options.element,"drop")),new qq.DragAndDrop({dropZoneElements:o,hideDropZonesBeforeEnter:this._options.dragAndDrop.hideDropzones,allowMultipleItems:this._options.multiple,classes:{dropActive:this._options.classes.dropActive},callbacks:{processingDroppedFiles:function(){var o=t._button.getInput();qq(n).css({display:"block"}),qq(o).attach("click",e)},processingDroppedFilesComplete:function(o){var i=t._button.getInput();qq(n).hide(),qq(i).detach("click",e),o&&t.addFiles(o)},dropError:function(e,n){t._itemError(e,n)},dropLog:function(e,n){t.log(e,n)}}})},_leaving_document_out:function(e){return(qq.chrome()||qq.safari()&&qq.windows())&&0==e.clientX&&0==e.clientY||qq.firefox()&&!e.relatedTarget},_storeForLater:function(e){qq.FineUploaderBasic.prototype._storeForLater.apply(this,arguments);var t=this.getItemByFileId(e);qq(this._find(t,"spinner")).hide()},_find:function(e,t){var n=qq(e).getByClass(this._options.classes[t])[0];if(!n)throw new Error("element not found "+t);return n},_onSubmit:function(e,t){qq.FineUploaderBasic.prototype._onSubmit.apply(this,arguments),this._addToList(e,t)},_onProgress:function(e,t,n,o){qq.FineUploaderBasic.prototype._onProgress.apply(this,arguments);var i,s,r,a;i=this.getItemByFileId(e),s=this._find(i,"progressBar"),r=Math.round(n/o*100),n===o?(a=this._find(i,"cancel"),qq(a).hide(),qq(s).hide(),qq(this._find(i,"statusText")).setText(this._options.text.waitingForResponse),this._displayFileSize(e)):(this._displayFileSize(e,n,o),qq(s).css({display:"block"})),qq(s).css({width:r+"%"})},_onComplete:function(e,t,n,o){qq.FineUploaderBasic.prototype._onComplete.apply(this,arguments);var i=this.getItemByFileId(e);qq(this._find(i,"statusText")).clearText(),qq(i).removeClass(this._classes.retrying),qq(this._find(i,"progressBar")).hide(),this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading||qq(this._find(i,"cancel")).hide(),qq(this._find(i,"spinner")).hide(),n.success?(this._isDeletePossible()&&this._showDeleteLink(e),qq(i).addClass(this._classes.success),this._classes.successIcon&&(this._find(i,"finished").style.display="inline-block",qq(i).addClass(this._classes.successIcon))):(qq(i).addClass(this._classes.fail),this._classes.failIcon&&(this._find(i,"finished").style.display="inline-block",qq(i).addClass(this._classes.failIcon)),this._options.retry.showButton&&!this._preventRetries[e]&&qq(i).addClass(this._classes.retryable),this._controlFailureTextDisplay(i,n))},_onUpload:function(e,t){qq.FineUploaderBasic.prototype._onUpload.apply(this,arguments),this._showSpinner(e)},_onCancel:function(e,t){qq.FineUploaderBasic.prototype._onCancel.apply(this,arguments),this._removeFileItem(e)},_onBeforeAutoRetry:function(e){var t,n,o,i,s,r;qq.FineUploaderBasic.prototype._onBeforeAutoRetry.apply(this,arguments),t=this.getItemByFileId(e),n=this._find(t,"progressBar"),this._showCancelLink(t),n.style.width=0,qq(n).hide(),this._options.retry.showAutoRetryNote&&(o=this._find(t,"statusText"),i=this._autoRetries[e]+1,s=this._options.retry.maxAutoAttempts,r=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,i),r=r.replace(/\{maxAuto\}/g,s),qq(o).setText(r),1===i&&qq(t).addClass(this._classes.retrying))},_onBeforeManualRetry:function(e){var t=this.getItemByFileId(e);return qq.FineUploaderBasic.prototype._onBeforeManualRetry.apply(this,arguments)?(this._find(t,"progressBar").style.width=0,qq(t).removeClass(this._classes.fail),qq(this._find(t,"statusText")).clearText(),this._showSpinner(e),this._showCancelLink(t),!0):(qq(t).addClass(this._classes.retryable),!1)},_onSubmitDelete:function(e){return this._isDeletePossible()?void(this._options.callbacks.onSubmitDelete(e)!==!1&&(this._options.deleteFile.forceConfirm?this._showDeleteConfirm(e):this._sendDeleteRequest(e))):(this.log("Delete request ignored for file ID "+e+", delete feature is disabled.","warn"),!1)},_onDeleteComplete:function(e,t,n){qq.FineUploaderBasic.prototype._onDeleteComplete.apply(this,arguments);var o=this.getItemByFileId(e),i=this._find(o,"spinner"),s=this._find(o,"statusText");qq(i).hide(),n?(qq(s).setText(this._options.deleteFile.deletingFailedText),this._showDeleteLink(e)):this._removeFileItem(e)},_sendDeleteRequest:function(e){var t=this.getItemByFileId(e),n=this._find(t,"deleteButton"),o=this._find(t,"statusText");qq(n).hide(),this._showSpinner(e),qq(o).setText(this._options.deleteFile.deletingStatusText),this._deleteHandler.sendDelete(e,this.getUuid(e))},_showDeleteConfirm:function(e){var t=this._handler.getName(e),n=this._options.deleteFile.confirmMessage.replace(/\{filename\}/g,t),o=(this.getUuid(e),this);this._options.showConfirm(n,function(){o._sendDeleteRequest(e)})},_addToList:function(e,t){var n=qq.toElement(this._options.fileTemplate);if(this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading){var o=this._find(n,"cancel");qq(o).remove()}n.qqFileId=e;var i=this._find(n,"file");qq(i).setText(this._options.formatFileName(t)),qq(this._find(n,"size")).hide(),this._options.multiple||(this._handler.cancelAll(),this._clearList()),this._listElement.appendChild(n),this._options.display.fileSizeOnSubmit&&qq.supportedFeatures.ajaxUploading&&this._displayFileSize(e)},_clearList:function(){this._listElement.innerHTML="",this.clearStoredFiles()},_displayFileSize:function(e,t,n){var o=this.getItemByFileId(e),i=this.getSize(e),s=this._formatSize(i),r=this._find(o,"size");void 0!==t&&void 0!==n&&(s=this._formatProgress(t,n)),qq(r).css({display:"inline"}),qq(r).setText(s)},_bindCancelAndRetryEvents:function(){var e=this,t=this._listElement;this._disposeSupport.attach(t,"click",function(t){t=t||window.event;var n=t.target||t.srcElement;if(qq(n).hasClass(e._classes.cancel)||qq(n).hasClass(e._classes.retry)||qq(n).hasClass(e._classes.deleteButton)){qq.preventDefault(t);for(var o=n.parentNode;void 0===o.qqFileId;)o=o.parentNode;qq(n).hasClass(e._classes.deleteButton)?e.deleteFile(o.qqFileId):qq(n).hasClass(e._classes.cancel)?e.cancel(o.qqFileId):(qq(o).removeClass(e._classes.retryable),e.retry(o.qqFileId))}})},_formatProgress:function(e,t){function n(e,t){o=o.replace(e,t)}var o=this._options.text.formatProgress;return n("{percent}",Math.round(e/t*100)),n("{total_size}",this._formatSize(t)),o},_controlFailureTextDisplay:function(e,t){var n,o,i,s,r;n=this._options.failedUploadTextDisplay.mode,o=this._options.failedUploadTextDisplay.maxChars,i=this._options.failedUploadTextDisplay.responseProperty,"custom"===n?(s=t[i],s?s.length>o&&(r=s.substring(0,o)+"..."):(s=this._options.text.failUpload,this.log("'"+i+"' is not a valid property on the server response.","warn")),qq(this._find(e,"statusText")).setText(r||s),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(e,s)):"default"===n?qq(this._find(e,"statusText")).setText(this._options.text.failUpload):"none"!==n&&this.log("failedUploadTextDisplay.mode value of '"+n+"' is not valid","warn")},_showTooltip:function(e,t){e.title=t},_showSpinner:function(e){var t=this.getItemByFileId(e),n=this._find(t,"spinner");n.style.display="inline-block"},_showCancelLink:function(e){if(!this._options.disableCancelForFormUploads||qq.supportedFeatures.ajaxUploading){var t=this._find(e,"cancel");qq(t).css({display:"inline"})}},_showDeleteLink:function(e){var t=this.getItemByFileId(e),n=this._find(t,"deleteButton");qq(n).css({display:"inline"})},_itemError:function(e,t){var n=qq.FineUploaderBasic.prototype._itemError.apply(this,arguments);this._options.showMessage(n)},_batchError:function(e){qq.FineUploaderBasic.prototype._batchError.apply(this,arguments),this._options.showMessage(e)},_setupPastePrompt:function(){var e=this;this._options.callbacks.onPasteReceived=function(){var t=e._options.paste.namePromptMessage,n=e._options.paste.defaultName;return e._options.showPrompt(t,n)}}}),qq.AjaxRequestor=function(e){"use strict";function t(e){var t,n=qq.indexOf(p,e),i=h.maxConnections;delete f[e],p.splice(n,1),p.length>=i&&n<i&&(t=p[i-1],o(t))}function n(e){var n=f[e].xhr,o=u(),i=!1;t(e),l(n.status)||(i=!0,d(o+" request for "+e+" has failed - response code "+n.status,"error")),h.onComplete(e,n,i)}function o(e){var t,n=new XMLHttpRequest,o=u(),a={};h.onSend(e),h.paramsStore.getParams&&(a=h.paramsStore.getParams(e)),t=i(e,a),f[e].xhr=n,n.onreadystatechange=s(e),n.open(o,t,!0),h.cors.expected&&h.cors.sendCredentials&&(n.withCredentials=!0),r(e),d("Sending "+o+" request for "+e),!c&&a?n.send(qq.obj2url(a,"")):n.send()}function i(e,t){var n=h.endpointStore.getEndpoint(e),o=f[e].addToPath;return void 0!==o&&(n+="/"+o),c&&t?qq.obj2url(t,n):n}function s(e){var t=f[e].xhr;return function(){4===t.readyState&&n(e,t)}}function r(e){var t=f[e].xhr,n=h.customHeaders;t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.setRequestHeader("Cache-Control","no-cache"),qq.each(n,function(e,n){t.setRequestHeader(e,n)})}function a(e){var n=f[e].xhr,o=u();return!!n&&(n.onreadystatechange=null,n.abort(),t(e),d("Cancelled "+o+" for "+e),h.onCancel(e),!0)}function l(e){return qq.indexOf(h.successfulResponseCodes,e)>=0}function u(){return h.demoMode?"GET":h.method}var d,c,p=[],f=[],h={method:"POST",maxConnections:3,customHeaders:{},endpointStore:{},paramsStore:{},successfulResponseCodes:[200],demoMode:!1,cors:{expected:!1,sendCredentials:!1},log:function(e,t){},onSend:function(e){},onComplete:function(e,t,n){},onCancel:function(e){}};return qq.extend(h,e),d=h.log,c="GET"===u()||"DELETE"===u(),{send:function(e,t){f[e]={addToPath:t};var n=p.push(e);n<=h.maxConnections&&o(e)},cancel:function(e){return a(e)}}},qq.DeleteFileAjaxRequestor=function(e){"use strict";var t,n={endpointStore:{},maxConnections:3,customHeaders:{},paramsStore:{},demoMode:!1,cors:{expected:!1,sendCredentials:!1},log:function(e,t){},onDelete:function(e){},onDeleteComplete:function(e,t,n){}};return qq.extend(n,e),t=new qq.AjaxRequestor({method:"DELETE",endpointStore:n.endpointStore,paramsStore:n.paramsStore,maxConnections:n.maxConnections,customHeaders:n.customHeaders,successfulResponseCodes:[200,202,204],demoMode:n.demoMode,log:n.log,onSend:n.onDelete,onComplete:n.onDeleteComplete}),{sendDelete:function(e,o){t.send(e,o),n.log("Submitted delete file request for "+e)}}},qq.WindowReceiveMessage=function(e){var t={log:function(e,t){}},n={};return qq.extend(t,e),{receiveMessage:function(e,t){var o=function(e){t(e.data)};window.postMessage?n[e]=qq(window).attach("message",o):log("iframe message passing not supported in this browser!","error")},stopReceivingMessages:function(e){if(window.postMessage){var t=n[e];t&&t()}}}},qq.UploadHandler=function(e){"use strict";var t,n,o,i,s=[];return t={debug:!1,forceMultipart:!0,paramsInBody:!1,paramsStore:{},endpointStore:{},cors:{expected:!1,sendCredentials:!1},maxConnections:3,uuidParamName:"qquuid",totalFileSizeParamName:"qqtotalfilesize",chunking:{enabled:!1,partSize:2e6,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalParts:"qqtotalparts",filename:"qqfilename"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},blobs:{paramNames:{name:"qqblobname"}},log:function(e,t){},onProgress:function(e,t,n,o){},onComplete:function(e,t,n,o){},onCancel:function(e,t){},onUpload:function(e,t){},onUploadChunk:function(e,t,n){},onAutoRetry:function(e,t,n,o){},onResume:function(e,t,n){}},qq.extend(t,e),n=t.log,o=function(e){var n,o=qq.indexOf(s,e),r=t.maxConnections;o>=0&&(s.splice(o,1),s.length>=r&&o<r&&(n=s[r-1],i.upload(n)))},i=qq.supportedFeatures.ajaxUploading?new qq.UploadHandlerXhr(t,o,n):new qq.UploadHandlerForm(t,o,n),{add:function(e){return i.add(e)},upload:function(e){var n=s.push(e);if(n<=t.maxConnections)return i.upload(e)},retry:function(e){var t=qq.indexOf(s,e);return t>=0?i.upload(e,!0):this.upload(e)},cancel:function(e){n("Cancelling "+e),t.paramsStore.remove(e),i.cancel(e),o(e)},cancelAll:function(){var e=this,t=[];qq.extend(t,s),qq.each(t,function(t,n){e.cancel(n)}),s=[]},getName:function(e){return i.getName(e)},getSize:function(e){if(i.getSize)return i.getSize(e)},getFile:function(e){if(i.getFile)return i.getFile(e)},getQueue:function(){return s},reset:function(){n("Resetting upload handler"),s=[],i.reset()},getUuid:function(e){return i.getUuid(e)},isValid:function(e){return i.isValid(e)},getResumableFilesData:function(){return i.getResumableFilesData?i.getResumableFilesData():[]}}},qq.UploadHandlerForm=function(e,t,n){"use strict";function o(e){void 0!==f[e]&&(f[e](),delete f[e])}function i(e,t){var n=e.id;_[p[n]]=t,f[n]=qq(e).attach("load",function(){c[n]&&(m("Received iframe load event for CORS upload request (file id "+n+")"),h[n]=setTimeout(function(){var e="No valid message received from loaded iframe for file id "+n;m(e,"error"),t({error:e})},1e3))}),g.receiveMessage(n,function(e){m("Received the following window message: '"+e+"'");var t,i=qq.parseJson(e),s=i.uuid;s&&_[s]?(clearTimeout(h[n]),delete h[n],o(n),t=_[s],delete _[s],g.stopReceivingMessages(n),t(i)):s||m("'"+e+"' does not contain a UUID - ignoring.")})}function s(e,t){d.cors.expected?i(e,t):f[e.id]=qq(e).attach("load",function(){if(m("Received response for "+e.id),e.parentNode){try{if(e.contentDocument&&e.contentDocument.body&&"false"==e.contentDocument.body.innerHTML)return}catch(n){m("Error when attempting to access iframe during handling of upload response ("+n+")","error")}t()}})}function r(e){var t;try{var n=e.contentDocument||e.contentWindow.document,o=n.body.innerHTML;m("converting iframe's innerHTML to JSON"),m("innerHTML = "+o),o&&o.match(/^<pre/i)&&(o=n.body.firstChild.firstChild.nodeValue),t=qq.parseJson(o)}catch(i){m("Error when attempting to parse form upload response ("+i+")","error"),t={success:!1}}return t}function a(e){var t=qq.toElement('<iframe src="javascript:false;" name="'+e+'" />');return t.setAttribute("id",e),t.style.display="none",document.body.appendChild(t),t}function l(e,t){var n=d.paramsStore.getParams(e),o=d.demoMode?"GET":"POST",i=qq.toElement('<form method="'+o+'" enctype="multipart/form-data"></form>'),s=d.endpointStore.getEndpoint(e),r=s;return n[d.uuidParamName]=p[e],d.paramsInBody?qq.obj2Inputs(n,i):r=qq.obj2url(n,s),i.setAttribute("action",r),i.setAttribute("target",t.name),i.style.display="none",document.body.appendChild(i),i}var u,d=e,c=[],p=[],f={},h={},q=t,m=n,g=new qq.WindowReceiveMessage({log:m}),_={};return u={add:function(e){e.setAttribute("name",d.inputName);var t=c.push(e)-1;return p[t]=qq.getUniqueId(),e.parentNode&&qq(e).remove(),t},getName:function(e){return u.isValid(e)?c[e].value.replace(/.*(\/|\\)/,""):void m(e+" is not a valid item ID.","error")},isValid:function(e){return void 0!==c[e]},reset:function(){c=[],p=[],f={}},getUuid:function(e){return p[e]},cancel:function(e){d.onCancel(e,this.getName(e)),delete c[e],delete p[e],delete f[e],d.cors.expected&&(clearTimeout(h[e]),delete h[e],g.stopReceivingMessages(e));var t=document.getElementById(e);t&&(t.setAttribute("src","java"+String.fromCharCode(115)+"cript:false;"),qq(t).remove())},upload:function(e){var t,n=c[e],i=u.getName(e),p=a(e);if(!n)throw new Error("file with passed id was not added, or already uploaded or cancelled");return d.onUpload(e,this.getName(e)),t=l(e,p),t.appendChild(n),s(p,function(t){m("iframe loaded");var n=t?t:r(p);o(e),d.cors.expected||qq(p).remove(),!n.success&&d.onAutoRetry(e,i,n)||(d.onComplete(e,i,n),q(e))}),m("Sending upload request for "+e),t.submit(),qq(t).remove(),e}}},qq.UploadHandlerXhr=function(e,t,n){"use strict";function o(e,t,n){var o=k.getSize(e),i=k.getName(e);t[U.chunking.paramNames.partIndex]=n.part,t[U.chunking.paramNames.partByteOffset]=n.start,t[U.chunking.paramNames.chunkSize]=n.size,t[U.chunking.paramNames.totalParts]=n.count,t[U.totalFileSizeParamName]=o,M&&(t[U.chunking.paramNames.filename]=i)}function i(e){e[U.resume.paramNames.resuming]=!0}function s(e,t,n){return e.slice?e.slice(t,n):e.mozSlice?e.mozSlice(t,n):e.webkitSlice?e.webkitSlice(t,n):void 0}function r(e,t){var n=U.chunking.partSize,o=k.getSize(e),i=P[e].file||P[e].blobData.blob,r=n*t,l=r+n>=o?o:r+n,u=a(e);return{part:t,start:r,end:l,count:u,blob:s(i,r,l),size:l-r}}function a(e){var t=k.getSize(e),n=U.chunking.partSize;return Math.ceil(t/n)}function l(e){var t=new XMLHttpRequest;return P[e].xhr=t,t}function u(e,t,n,o){var i=new FormData,s=U.demoMode?"GET":"POST",r=U.endpointStore.getEndpoint(o),a=r,l=k.getName(o),u=k.getSize(o),d=P[o].blobData;return e[U.uuidParamName]=P[o].uuid,M&&(e[U.totalFileSizeParamName]=u,d&&(e[U.blobs.paramNames.name]=d.name)),U.paramsInBody||(M||(e[U.inputName]=l),a=qq.obj2url(e,r)),t.open(s,a,!0),U.cors.expected&&U.cors.sendCredentials&&(t.withCredentials=!0),M?(U.paramsInBody&&qq.obj2FormData(e,i),i.append(U.inputName,n),i):n}function d(e,t){var n=U.customHeaders,o=P[e].file||P[e].blobData.blob;t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.setRequestHeader("Cache-Control","no-cache"),M||(t.setRequestHeader("Content-Type","application/octet-stream"),t.setRequestHeader("X-Mime-Type",o.type)),qq.each(n,function(e,n){t.setRequestHeader(e,n)})}function c(e,t,n){var o=k.getName(e),i=k.getSize(e);P[e].attemptingResume=!1,U.onProgress(e,o,i,i),U.onComplete(e,o,t,n),delete P[e].xhr,T(e)}function p(e){var t,n,s=P[e].remainingChunkIdxs[0],a=r(e,s),c=l(e),p=k.getSize(e),h=k.getName(e);void 0===P[e].loaded&&(P[e].loaded=0),A&&P[e].file&&C(e,a),c.onreadystatechange=F(e,c),c.upload.onprogress=function(t){if(t.lengthComputable){var n=t.loaded+P[e].loaded,o=f(e,s,t.total);U.onProgress(e,h,n,o)}},U.onUploadChunk(e,h,x(a)),n=U.paramsStore.getParams(e),o(e,n,a),P[e].attemptingResume&&i(n),t=u(n,c,a.blob,e),d(e,c),B("Sending chunked upload request for item "+e+": bytes "+(a.start+1)+"-"+a.end+" of "+p),c.send(t)}function f(e,t,n){var o=r(e,t),i=o.size,s=n-i,a=k.getSize(e),l=o.count,u=P[e].initialRequestOverhead,d=s-u;return P[e].lastRequestOverhead=s,0===t?(P[e].lastChunkIdxProgress=0,P[e].initialRequestOverhead=s,P[e].estTotalRequestsSize=a+l*s):P[e].lastChunkIdxProgress!==t&&(P[e].lastChunkIdxProgress=t,P[e].estTotalRequestsSize+=d),P[e].estTotalRequestsSize}function h(e){return M?P[e].lastRequestOverhead:0}function q(e,t,n){var o=P[e].remainingChunkIdxs.shift(),i=r(e,o);P[e].attemptingResume=!1,P[e].loaded+=i.size+h(e),P[e].remainingChunkIdxs.length>0?p(e):(A&&S(e),c(e,t,n))}function m(e,t){return 200!==e.status||!t.success||t.reset}function g(e){var t;try{t=qq.parseJson(e.responseText)}catch(n){B("Error when attempting to parse xhr response text ("+n+")","error"),t={}}return t}function _(e){B("Server has ordered chunking effort to be restarted on next attempt for item ID "+e,"error"),A&&(S(e),P[e].attemptingResume=!1),P[e].remainingChunkIdxs=[],delete P[e].loaded,delete P[e].estTotalRequestsSize,delete P[e].initialRequestOverhead}function v(e){P[e].attemptingResume=!1,B("Server has declared that it cannot handle resume for item ID "+e+" - starting from the first chunk","error"),_(e),k.upload(e,!0)}function b(e,t,n){var o=k.getName(e);U.onAutoRetry(e,o,t,n)||c(e,t,n)}function y(e,t){var n;P[e]&&(B("xhr - server response received for "+e),B("responseText = "+t.responseText),n=g(t),m(t,n)?(n.reset&&_(e),P[e].attemptingResume&&n.reset?v(e):b(e,n,t)):N?q(e,n,t):c(e,n,t))}function x(e){return{partIndex:e.part,startByte:e.start+1,endByte:e.end,totalParts:e.count}}function F(e,t){return function(){4===t.readyState&&y(e,t)}}function C(e,t){var n=k.getUuid(e),o=P[e].loaded,i=P[e].initialRequestOverhead,s=P[e].estTotalRequestsSize,r=w(e),a=n+z+t.part+z+o+z+i+z+s,l=U.resume.cookiesExpireIn;qq.setCookie(r,a,l)}function S(e){if(P[e].file){var t=w(e);qq.deleteCookie(t)}}function D(e){var t,n,o,i,s,r,a=qq.getCookie(w(e)),l=k.getName(e);if(a){if(t=a.split(z),5===t.length)return n=t[0],o=parseInt(t[1],10),i=parseInt(t[2],10),s=parseInt(t[3],10),r=parseInt(t[4],10),{uuid:n,part:o,lastByteSent:i,initialRequestOverhead:s,estTotalRequestsSize:r};B("Ignoring previously stored resume/chunk cookie for "+l+" - old cookie format","warn")}}function w(e){var t,n=k.getName(e),o=k.getSize(e),i=U.chunking.partSize;return t="qqfilechunk"+z+encodeURIComponent(n)+z+o+z+i,void 0!==O&&(t+=z+O),t}function E(){if(null!==U.resume.id&&void 0!==U.resume.id&&!qq.isFunction(U.resume.id)&&!qq.isObject(U.resume.id))return U.resume.id}function R(e,t){var n,o,i,s=k.getName(e),l=0;if(!P[e].remainingChunkIdxs||0===P[e].remainingChunkIdxs.length)for(P[e].remainingChunkIdxs=[],A&&!t&&P[e].file&&(n=D(e),n&&(o=r(e,n.part),U.onResume(e,s,x(o))!==!1&&(l=n.part,P[e].uuid=n.uuid,P[e].loaded=n.lastByteSent,P[e].estTotalRequestsSize=n.estTotalRequestsSize,P[e].initialRequestOverhead=n.initialRequestOverhead,P[e].attemptingResume=!0,B("Resuming "+s+" at partition index "+l)))),i=a(e)-1;i>=l;i-=1)P[e].remainingChunkIdxs.unshift(i);p(e)}function I(e){var t,n,o,i=P[e].file||P[e].blobData.blob,s=k.getName(e);P[e].loaded=0,t=l(e),t.upload.onprogress=function(t){t.lengthComputable&&(P[e].loaded=t.loaded,U.onProgress(e,s,t.loaded,t.total))},t.onreadystatechange=F(e,t),n=U.paramsStore.getParams(e),o=u(n,t,i,e),d(e,t),B("Sending upload request for "+e),t.send(o)}var k,U=e,T=t,B=n,P=[],z="|",N=U.chunking.enabled&&qq.supportedFeatures.chunking,A=U.resume.enabled&&N&&qq.supportedFeatures.resume,O=E(),M=U.forceMultipart||U.paramsInBody;return k={add:function(e){var t;if(e instanceof File)t=P.push({file:e})-1;else{if(!qq.isBlob(e.blob))throw new Error("Passed obj in not a File or BlobData (in qq.UploadHandlerXhr)");t=P.push({blobData:e})-1}return P[t].uuid=qq.getUniqueId(),t},getName:function(e){if(k.isValid(e)){var t=P[e].file,n=P[e].blobData;return t?null!==t.fileName&&void 0!==t.fileName?t.fileName:t.name:n.name}B(e+" is not a valid item ID.","error")},getSize:function(e){var t=P[e].file||P[e].blobData.blob;return qq.isFileOrInput(t)&&null!=t.fileSize?t.fileSize:t.size},getFile:function(e){if(P[e])return P[e].file||P[e].blobData.blob},getLoaded:function(e){return P[e].loaded||0},isValid:function(e){return void 0!==P[e]},reset:function(){P=[]},getUuid:function(e){return P[e].uuid},upload:function(e,t){var n=this.getName(e);U.onUpload(e,n),N?R(e,t):I(e)},cancel:function(e){var t=P[e].xhr;U.onCancel(e,this.getName(e)),t&&(t.onreadystatechange=null,t.abort()),A&&S(e),delete P[e]},getResumableFilesData:function(){var e=[],t=[];return N&&A?(e=void 0===O?qq.getCookieNames(new RegExp("^qqfilechunk\\"+z+".+\\"+z+"\\d+\\"+z+U.chunking.partSize+"=")):qq.getCookieNames(new RegExp("^qqfilechunk\\"+z+".+\\"+z+"\\d+\\"+z+U.chunking.partSize+"\\"+z+O+"=")),qq.each(e,function(e,n){var o=n.split(z),i=qq.getCookie(n).split(z);t.push({name:decodeURIComponent(o[1]),size:o[2],uuid:i[0],partIdx:i[1]})}),t):[]}}},function(e){"use strict";var t,n,o,i,s,r,a,l,u,d;r=["uploaderType"],o=function(e){if(e){var o=l(e);a(o),t("basic"===s("uploaderType")?new qq.FineUploaderBasic(o):new qq.FineUploader(o))}return n},i=function(e,t){var o=n.data("fineuploader");return t?(void 0===o&&(o={}),o[e]=t,n.data("fineuploader",o),void 0):void 0===o?null:o[e]},t=function(e){return i("uploader",e)},s=function(e,t){return i(e,t)},a=function(t){var o=t.callbacks={},i=new qq.FineUploaderBasic;e.each(i._options.callbacks,function(e,t){var i,s;i=/^on(\w+)/.exec(e)[1],i=i.substring(0,1).toLowerCase()+i.substring(1),s=n,o[e]=function(){var e=Array.prototype.slice.call(arguments);return s.triggerHandler(i,e)}})},l=function(t,o){var i,a;if(i=void 0===o?"basic"!==t.uploaderType?{element:n[0]}:{}:o,e.each(t,function(t,n){e.inArray(t,r)>=0?s(t,n):n instanceof e?i[t]=n[0]:e.isPlainObject(n)?(i[t]={},l(n,i[t])):e.isArray(n)?(a=[],e.each(n,function(t,n){n instanceof e?e.merge(a,n):a.push(n)}),i[t]=a):i[t]=n}),void 0===o)return i},u=function(n){return"string"===e.type(n)&&!n.match(/^_/)&&void 0!==t()[n]},d=function(e){var n=[],o=Array.prototype.slice.call(arguments,1);return l(o,n),t()[e].apply(t(),n)},e.fn.fineUploader=function(i){var s=this,r=arguments,a=[];return this.each(function(l,c){if(n=e(c),t()&&u(i)){if(a.push(d.apply(s,r)),1===s.length)return!1}else"object"!=typeof i&&i?e.error("Method "+i+" does not exist on jQuery.fineUploader"):o.apply(s,r)}),1===a.length?a[0]:a.length>1?a:this}}(jQuery),function(e){"use strict";function t(e){e||(e={}),e.dropZoneElements=[l];var t=s(e);return i(t),o(new qq.DragAndDrop(t)),l}function n(e,t){var n=l.data(u);return t?(void 0===n&&(n={}),n[e]=t,l.data(u,n),void 0):void 0===n?null:n[e]}function o(e){return n("dndInstance",e)}function i(t){var n=t.callbacks={};new qq.FineUploaderBasic;e.each(new qq.DragAndDrop.callbacks,function(e,t){var o,i=e;o=l,n[e]=function(){var e=Array.prototype.slice.call(arguments),t=o.triggerHandler(i,e);return t}})}function s(t,n){var o,i;if(o=void 0===n?{}:n,e.each(t,function(t,n){n instanceof e?o[t]=n[0]:e.isPlainObject(n)?(o[t]={},s(n,o[t])):e.isArray(n)?(i=[],e.each(n,function(t,n){n instanceof e?e.merge(i,n):i.push(n)}),o[t]=i):o[t]=n}),void 0===n)return o}function r(t){return"string"===e.type(t)&&"dispose"===t&&void 0!==o()[t]}function a(e){var t=[],n=Array.prototype.slice.call(arguments,1);return s(n,t),o()[e].apply(o(),t)}var l,u="fineUploaderDnd";e.fn.fineUploaderDnd=function(n){var i=this,s=arguments,u=[];return this.each(function(d,c){if(l=e(c),o()&&r(n)){if(u.push(a.apply(i,s)),1===i.length)return!1}else"object"!=typeof n&&n?e.error("Method "+n+" does not exist in Fine Uploader's DnD module."):t.apply(i,s)}),1===u.length?u[0]:u.length>1?u:this}}(jQuery);
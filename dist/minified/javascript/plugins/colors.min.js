!function(o){o.Editable.DEFAULTS=o.extend(o.Editable.DEFAULTS,{colors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],colorsStep:7,colorGroups:[{text:"Text",cmd:"foreColor"},{text:"Background",cmd:"backColor"}],defaultColorGroup:"foreColor"}),o.Editable.prototype.refreshColors=function(){var o=this.getSelectionElement();this.$editor.find(".fr-color-picker button.fr-color-bttn").removeClass("active"),this.refreshColor(o,"background-color","backColor"),this.refreshColor(o,"color","foreColor")},o.Editable.prototype.refreshColor=function(t,r,e){for(;o(t).get(0)!=this.$element.get(0);){if("transparent"!==o(t).css(r)&&"rgba(0, 0, 0, 0)"!==o(t).css(r)){this.$editor.find('.fr-color-picker button.fr-color-bttn[data-param="'+e+'"][data-val="'+o.Editable.RGBToHex(o(t).css(r))+'"]').addClass("active");break}t=o(t).parent()}},o.Editable.commands=o.extend(o.Editable.commands,{color:{icon:"fa fa-tint",title:"Color",refreshOnShow:o.Editable.prototype.refreshColors,callback:function(o,t,r){this[r].apply(this,[t])},callbackWithoutSelection:function(t,r,e){"backColor"===e&&(e="background-color"),"foreColor"===e&&(e="color"),this._startInFontExec(e,t,r),"#123456"===r&&""===this.text()&&(this.cleanify(!0,!1),this.$element.find("span").each(function(t,r){var e=o(r),s=e.css("background-color");"#123456"!==s&&"#123456"!==o.Editable.RGBToHex(s)||e.css("background-color",""),s=e.css("color"),"#123456"!==s&&"#123456"!==o.Editable.RGBToHex(s)||e.css("color","")}))},undo:!0}}),o.Editable.prototype.command_dispatcher=o.extend(o.Editable.prototype.command_dispatcher,{color:function(o){var t=this.buildDropdownColor(o),r=this.buildDropdownButton(o,t,"fr-color-picker");return r}}),o.Editable.prototype.buildColorList=function(o,t){for(var r=this.options.defaultColorGroup==o?"block":"none",e='<div class="fr-color-set fr-'+o+'" style="display: '+r+'">',s=0;s<t.length;s++){var a=t[s];e+="REMOVE"!==a?'<button type="button" class="fr-color-bttn" data-val="'+a+'" data-cmd="color" data-param="'+o+'" style="background: '+a+';">&nbsp;</button>':'<button type="button" class="fr-color-bttn" data-val="#123456" data-cmd="color" data-param="'+o+'" style="background: #FFF;"><i class="fa fa-eraser"></i></button>',s%this.options.colorsStep==this.options.colorsStep-1&&s>0&&(e+="<hr/>",s!=this.options.colorsStep-1&&s!=2*this.options.colorsStep-1||!this.options.colorsTopChoices||(e+='<div class="separator"></div>'))}return e+="</div>"},o.Editable.prototype.buildDropdownColor=function(){for(var t="",r='<div class="fr-dropdown-menu">',e=0;e<this.options.colorGroups.length;e++)r+=this.buildColorList(this.options.colorGroups[e].cmd,this.options.colorGroups[e].colors||this.options.colors);for(r+="<p>",e=0;e<this.options.colorGroups.length;e++)t=this.options.defaultColorGroup==this.options.colorGroups[e].cmd?"active":"",r+='<span class="fr-choose-color '+t+'" data-text="true" data-param="'+this.options.colorGroups[e].cmd+'" style="width: '+100/this.options.colorGroups.length+'%;">'+this.options.colorGroups[e].text+"</span>";r+="</p></div>",this.$bttn_wrapper.on(this.mousedown,".fr-choose-color",function(o){if(o.preventDefault(),o.stopPropagation(),"mousedown"===o.type&&1!==o.which)return!0});var s=this;return this.$bttn_wrapper.on(this.mouseup,".fr-choose-color",function(t){if(t.preventDefault(),t.stopPropagation(),"mouseup"===t.type&&1!==t.which)return!0;var r=o(this);r.siblings().removeClass("active"),r.addClass("active"),r.parents(".fr-dropdown-menu").find("button").attr("data-param",r.attr("data-param")),r.parents(".fr-dropdown-menu").find(".fr-color-set").hide(),r.parents(".fr-dropdown-menu").find(".fr-color-set.fr-"+r.attr("data-param")).show(),s.refreshColors()}),r},o.Editable.prototype.backColor=function(t){this.inlineStyle("background-color","backColor",t),this.saveSelectionByMarkers(),this.$element.find("span").each(function(t,r){var e=o(r),s=e.css("background-color");"#123456"!==s&&"#123456"!==o.Editable.RGBToHex(s)||(e.css("background-color",""),e.find("span").each(function(t,r){var e=o(r);e.css("background-color",""),""!==e.attr("style")||e.hasClass("f-marker")||e.replaceWith(e.contents())})),""!==e.attr("style")||e.hasClass("f-marker")||e.replaceWith(e.contents())}),this.restoreSelectionByMarkers(),this.cleanify();var r=this.$editor.find('button.fr-color-bttn[data-cmd="backColor"][data-val="'+t+'"]');r.addClass("active"),r.siblings().removeClass("active")},o.Editable.prototype.foreColor=function(t){this.inlineStyle("color","foreColor",t),this.saveSelectionByMarkers(),this.$element.find("span").each(function(t,r){var e=o(r),s=e.css("color");"#123456"!==s&&"#123456"!==o.Editable.RGBToHex(s)||(e.css("color",""),e.find("span").each(function(t,r){var e=o(r);e.css("color",""),""!==e.attr("style")||e.hasClass("f-marker")||e.replaceWith(e.contents())})),""!==e.attr("style")||e.hasClass("f-marker")||e.replaceWith(e.contents())}),this.restoreSelectionByMarkers(),this.cleanify();var r=this.$editor.find('button.fr-color-bttn[data-cmd="foreColor"][data-val="'+t+'"]');r.addClass("active"),r.siblings().removeClass("active")}}(jQuery);